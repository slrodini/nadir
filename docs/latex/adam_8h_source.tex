\doxysection{adam.\+h}
\hypertarget{adam_8h_source}{}\label{adam_8h_source}\index{/mnt/d/Code/nadir/inc/nadir/adam.h@{/mnt/d/Code/nadir/inc/nadir/adam.h}}
\mbox{\hyperlink{adam_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ NADIR\_ADAM\_H}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ NADIR\_ADAM\_H}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{abstract__classes_8h}{nadir/abstract\_classes.h}}"{}}}
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <Eigen/Core>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <functional>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <optional>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <sstream>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <fstream>}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00020\ \textcolor{keyword}{namespace\ }nadir}
\DoxyCodeLine{00021\ \{}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00030\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classnadir_1_1Adam}{Adam}}}
\DoxyCodeLine{00031\ \{}
\DoxyCodeLine{00032\ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \textcolor{keyword}{enum\ class}\ \mbox{\hyperlink{classnadir_1_1Adam_a9f832e64f5ab4b71b1420e74464a0ef8}{STATUS}}\ :\ \textcolor{keywordtype}{unsigned}\ \{}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \ SUCCESS\ \ =\ 0,}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ \ ABORT\ \ \ \ =\ 1,}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \ MAX\_IT\ \ \ =\ 2,}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \ LOW\_DIFF\ =\ 3,}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \ CONTINUE\ =\ 4,}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \};}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00043\ \ \ \ \ \ \ \textcolor{keyword}{enum\ class}\ \mbox{\hyperlink{classnadir_1_1Adam_adbfcdf6bc962fa867b471f9d246b7b7c}{ADAM\_VARIANT}}\ :\ \textcolor{keywordtype}{unsigned}\ \{}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \ CLASSIC,}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \ AMSGRAD,}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \ AMSGRAD\_V2,}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \ NADAM,}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \ ADAMW,}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \ ADABELIEF,}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \ ADABELIEF\_W,\ \textcolor{comment}{//\ AdaBelief\ with\ decoupled\ weight\ decay}}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \ LION,}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \ RADAM,}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \};}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00056\ \ \ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structnadir_1_1Adam_1_1MetaParameters}{MetaParameters}}\ \{}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classnadir_1_1Adam_adbfcdf6bc962fa867b471f9d246b7b7c}{ADAM\_VARIANT}}\ \mbox{\hyperlink{structnadir_1_1Adam_1_1MetaParameters_a262bac1725d4dbc356e9858f1ff2728c}{variant}}\ =\ ADAM\_VARIANT::CLASSIC;}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{structnadir_1_1Adam_1_1MetaParameters_ad06be8edae6a2c79068014eb1906b81c}{max\_it}}\ =\ 100;}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structnadir_1_1Adam_1_1MetaParameters_a8f61cebc62b89c93125cbf0d3df15b0d}{alpha}}\ =\ 0.001;}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structnadir_1_1Adam_1_1MetaParameters_af8027e72912e465cbd728b39619ffb62}{beta1}}\ =\ 0.9;}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structnadir_1_1Adam_1_1MetaParameters_a72873ac0b051d17eeca0f07eb6990f76}{beta2}}\ =\ 0.999;}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structnadir_1_1Adam_1_1MetaParameters_a7cef65de12a015dd7adb5bbe33be3e42}{eps}}\ =\ 1.0e-\/8;}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structnadir_1_1Adam_1_1MetaParameters_a7a051b22c3689419683860fd687eba87}{grad\_toll}}\ =\ 1.0e-\/8;}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structnadir_1_1Adam_1_1MetaParameters_a9c8de7b8de4a3021a49b61745fd76f9f}{diff\_value\_toll}}\ =\ 1.0e-\/8;}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structnadir_1_1Adam_1_1MetaParameters_a21f826b4b8d9a459e90ae5a03e5aa9f3}{lambda}}\ =\ 0.;}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \};}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00086\ \ \ \ \ \ \ \mbox{\hyperlink{classnadir_1_1Adam_a5290b66b95fcba3145a776c367771952}{Adam}}(\mbox{\hyperlink{classnadir_1_1NadirCostFunction}{NadirCostFunction}}\ \&fnc,\ Eigen::VectorXd\ pars\ =\ Eigen::VectorXd::Zero(1));}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00094\ \ \ \ \ \ \ \mbox{\hyperlink{classnadir_1_1Adam_a4a797b8e7e97ba70be3ceac0581d5f59}{Adam}}(\mbox{\hyperlink{classnadir_1_1NadirCostFunction}{NadirCostFunction}}\ \&fnc,\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{int}\ n\_par\ =\ 1);}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00102\ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnadir_1_1Adam_ae55f12d90e2cf54dc07c5452b5c39414}{SetScheduler}}(\textcolor{keyword}{const}\ std::function<\textcolor{keywordtype}{double}(\textcolor{keywordtype}{size\_t})>\ \&scheduler)}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \ \_scheduler\ =\ scheduler;}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00112\ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnadir_1_1Adam_a75e7fa524c0dd80587b2a15c7313acc0}{SetInitialParameters}}(\textcolor{keyword}{const}\ Eigen::VectorXd\ \&pars)}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \_parameters\ =\ pars;}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00122\ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnadir_1_1Adam_ae93869ac3b7ad655bc101f5727e3d932}{AddCallBack}}(\mbox{\hyperlink{classnadir_1_1NadirIterCallback}{NadirIterCallback}}\ \&f)}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \_fnc\_callback\ =\ f;}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00128\ \ \ \ \ \ \ \textcolor{keyword}{const}\ Eigen::VectorXd\ \&\mbox{\hyperlink{classnadir_1_1Adam_a3ddcd43a5edcbe6dee36e3766ade2a0a}{GetParameters}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00129\ \textcolor{keyword}{\ \ \ \ \ \ }\{}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_parameters;}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00141\ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnadir_1_1Adam_a9c4147311d1bbea6661d25f9839f86af}{SetMetaParameters}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structnadir_1_1Adam_1_1MetaParameters}{MetaParameters}}\ \&mp)}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \ \_mp\ =\ mp;}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00147\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structnadir_1_1Adam_1_1MetaParameters}{MetaParameters}}\ \&\mbox{\hyperlink{classnadir_1_1Adam_a1e2db63a20a6fc35e56043f3ca6cd936}{GetMetaParameters}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00148\ \textcolor{keyword}{\ \ \ \ \ \ }\{}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_mp;}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00157\ \ \ \ \ \ \ \mbox{\hyperlink{classnadir_1_1Adam_a9f832e64f5ab4b71b1420e74464a0ef8}{STATUS}}\ \mbox{\hyperlink{classnadir_1_1Adam_a80ab9e2e4a121caf2ae4cfe5b94924c2}{minimize}}();}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00160\ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnadir_1_1Adam_ae8c2ccc2ff48f6b169ba7235f5298127}{FlusToFile}}(\textcolor{keyword}{const}\ std::string\ \&filename)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00161\ \textcolor{keyword}{\ \ \ \ \ \ }\{}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ std::ofstream\ file(filename);}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (file.is\_open())\ \{}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \ \ \ \ file\ <<\ \_buffer.str();}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \ \ \ \ file.close();}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}FlushToFile:\ Could\ not\ open\ file:\ "{}}\ +\ filename);}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00172\ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnadir_1_1Adam_a087022cd9e35b50e8812a30eb9a46f40}{FlusToStdout}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00173\ \textcolor{keyword}{\ \ \ \ \ \ }\{}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \ std::cout\ <<\ \_buffer.str()\ <<\ std::endl;}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00177\ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00179\ \ \ \ \ \ \ std::reference\_wrapper<NadirCostFunction>\ \_fnc;}
\DoxyCodeLine{00181\ \ \ \ \ \ \ std::optional<std::reference\_wrapper<NadirIterCallback>>\ \_fnc\_callback;}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00184\ \ \ \ \ \ \ Eigen::VectorXd\ \_parameters;}
\DoxyCodeLine{00185\ }
\DoxyCodeLine{00187\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ f\_new,\ f\_old;}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00190\ \ \ \ \ \ \ Eigen::VectorXd\ \_gt,\ \_mt,\ \_vt;}
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00193\ \ \ \ \ \ \ Eigen::VectorXd\ \_vt\_hat;}
\DoxyCodeLine{00194\ }
\DoxyCodeLine{00196\ \ \ \ \ \ \ MetaParameters\ \_mp;}
\DoxyCodeLine{00197\ }
\DoxyCodeLine{00199\ \ \ \ \ \ \ std::function<double(\textcolor{keywordtype}{size\_t})>\ \_scheduler;}
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00202\ \ \ \ \ \ \ std::ostringstream\ \_buffer;}
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00206\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ step(\textcolor{keywordtype}{size\_t});}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ step\_ams(\textcolor{keywordtype}{size\_t});}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ step\_ams\_v2(\textcolor{keywordtype}{size\_t});}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ step\_nadam(\textcolor{keywordtype}{size\_t});}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ step\_adamw(\textcolor{keywordtype}{size\_t});}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ step\_adabelief(\textcolor{keywordtype}{size\_t});}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ step\_adabelief\_w(\textcolor{keywordtype}{size\_t});}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ step\_lion(\textcolor{keywordtype}{size\_t});}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ step\_radam(\textcolor{keywordtype}{size\_t});}
\DoxyCodeLine{00216\ }
\DoxyCodeLine{00218\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::function<double(\textcolor{keywordtype}{double})>\ sign\ =\ [](\textcolor{keywordtype}{double}\ x)\ \{}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (x\ >\ 0)\ -\/\ (x\ <\ 0);}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \};}
\DoxyCodeLine{00221\ \};}
\DoxyCodeLine{00222\ \}\ \textcolor{comment}{//\ namespace\ nadir}}
\DoxyCodeLine{00223\ }
\DoxyCodeLine{00224\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
